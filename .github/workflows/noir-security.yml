name: OWASP Noir Security Scan (Frontend)

on:
  workflow_dispatch:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]

jobs:
  noir-security:
    name: Run OWASP Noir (Frontend)
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      # --- 1) Escaneo de código fuente del frontend ---
      - name: OWASP Noir - Source Code Scan
        uses: owasp-noir/noir@v0.25.0
        with:
          targets: |
            src/
            public/
            package.json
            vite.config.ts
            tailwind.config.js

      # --- 2) Escaneo dinámico (DAST) de la app en producción ---
      # Cambia esta URL si usas otro dominio
      - name: OWASP Noir - Live App Scan
        uses: owasp-noir/noir@v0.25.0
        with:
          targets: |
            https://smartpot.app/